async function getStockPrice() {
    const input = document.getElementById("symbol");
    const symbol = input.value.toUpperCase().trim();
    const resultDiv = document.getElementById("result");
    const button = document.querySelector('button'); // Sélectionner le bouton

    if (!symbol) return resultDiv.textContent = "Veuillez entrer un symbole boursier.";

    resultDiv.innerHTML = "Chargement...";
    button.disabled = true; // Désactiver le bouton pendant l'appel

    try {
        const apiKey = 'BUJ9ONXMDU2BK43K';
        const url = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${apiKey}`;

        const response = await fetch(url);
        const data = await response.json();

        // Gestion de l'erreur d'API (ex: dépassement du taux d'appel)
        if (data["Error Message"]) {
             resultDiv.textContent = `Erreur API : ${data["Error Message"]}. Attendez une minute avant de réessayer.`;
             return;
        }

        if (!data["Global Quote"] || !data["Global Quote"]["05. price"]) {
            resultDiv.textContent = "Aucune donnée trouvée pour ce symbole (Symbole invalide ou pas de données disponibles).";
            return;
        }

        const quote = data["Global Quote"];
        
        // Détermination simple de la devise (pas toujours précis sans information supplémentaire)
        const currency = symbol.endsWith('.PA') ? 'EUR' : 'USD'; 

        resultDiv.innerHTML = `
            <strong>${symbol}</strong><br>
            Prix actuel : <strong>${parseFloat(quote["05. price"]).toFixed(2)} ${currency}</strong><br>
            Ouverture : ${parseFloat(quote["02. open"]).toFixed(2)} ${currency}<br>
            Haut : ${parseFloat(quote["03. high"]).toFixed(2)} ${currency}<br>
            Bas : ${parseFloat(quote["04. low"]).toFixed(2)} ${currency}<br>
            Variation : ${parseFloat(quote["09. change"]).toFixed(2)} (${quote["10. change percent"]})
        `;
        input.value = ''; // Nettoyer le champ après succès

    } catch (error) {
        console.error(error);
        resultDiv.textContent = "Erreur réseau lors de la récupération des données.";
    } finally {
        button.disabled = false; // Réactiver le bouton
    }
}
// Ajout de l'écouteur d'événement pour la touche 'Enter'
document.getElementById("symbol").addEventListener("keypress", function(event) {
    if (event.key === "Enter") {
        getStockPrice();
    }
});
